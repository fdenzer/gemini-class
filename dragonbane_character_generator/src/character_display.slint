// character_display.slint

import { VerticalBox, HorizontalBox, GroupBox, Label } from "std-widgets.slint";

export global CharacterData {
    in-out property <string> name;
    in-out property <string> kin;
    in-out property <string> profession;
    in-out property <string> age;
    in-out property <string> appearance;
    in-out property <string> weakness;

    // Attributes
    in-out property <int> str;
    in-out property <int> con;
    in-out property <int> agl;
    in-out property <int> intel; // 'int' is a keyword in Slint
    in-out property <int> wil;
    in-out property <int> cha;

    // Derived Ratings
    in-out property <int> hp_current;
    in-out property <int> hp_max;
    in-out property <int> wp_current;
    in-out property <int> wp_max;
    in-out property <int> movement;
    in-out property <string> dmg_bonus_str;
    in-out property <string> dmg_bonus_agl;

    // Abilities & Spells (simple strings for now)
    in-out property <[string]> innate_abilities;
    in-out property <[string]> heroic_abilities;
    in-out property <[string]> spells;

    // Skills (just names and levels for now)
    in-out property <[{ name: string, level: int, base_attr: string }] mutating > skills;
}

export component CharacterWindow inherits Window {
    title: "Dragonbane Character: \{CharacterData.name}";
    width: 800px;
    height: 600px;

    VerticalBox {
        padding: 10px;
        spacing: 10px;

        HorizontalBox {
            GroupBox {
                title: "Basic Info";
                VerticalBox {
                    Label { text: "Name: \{CharacterData.name}"; }
                    Label { text: "Kin: \{CharacterData.kin}"; }
                    Label { text: "Profession: \{CharacterData.profession}"; }
                    Label { text: "Age: \{CharacterData.age}"; }
                    Label { text: "Weakness: \{CharacterData.weakness}"; }
                }
            }
            GroupBox {
                title: "Appearance";
                Label { text: CharacterData.appearance; wrap: word-wrap; }
            }
        }

        HorizontalBox {
            GroupBox {
                title: "Attributes";
                VerticalBox {
                    Label { text: "STR: \{CharacterData.str}"; }
                    Label { text: "CON: \{CharacterData.con}"; }
                    Label { text: "AGL: \{CharacterData.agl}"; }
                    Label { text: "INT: \{CharacterData.intel}"; }
                    Label { text: "WIL: \{CharacterData.wil}"; }
                    Label { text: "CHA: \{CharacterData.cha}"; }
                }
            }

            GroupBox {
                title: "Derived Ratings";
                VerticalBox {
                    Label { text: "HP: \{CharacterData.hp_current}/\{CharacterData.hp_max}"; }
                    Label { text: "WP: \{CharacterData.wp_current}/\{CharacterData.wp_max}"; }
                    Label { text: "Movement: \{CharacterData.movement}"; }
                    Label { text: "Dmg Bonus STR: \{CharacterData.dmg_bonus_str}"; }
                    Label { text: "Dmg Bonus AGL: \{CharacterData.dmg_bonus_agl}"; }
                }
            }
        }

        HorizontalBox {
            GroupBox {
                title: "Innate Abilities";
                VerticalBox {
                    for ability in CharacterData.innate_abilities : Label { text: "- \{ability}"; }
                }
            }
            GroupBox {
                title: "Heroic Abilities";
                VerticalBox {
                    for ability in CharacterData.heroic_abilities : Label { text: "- \{ability}"; }
                }
            }
            GroupBox {
                title: "Spells";
                VerticalBox {
                    for spell in CharacterData.spells : Label { text: "- \{spell}"; }
                }
            }
        }

        GroupBox {
            title: "Skills";
            VerticalLayout {
                for skill_item[i] in CharacterData.skills : HorizontalBox {
                    Label { text: "\{skill_item.name} (\(skill_item.base_attr)):"; }
                    Label { text: "\{skill_item.level}"; }
                }
            }
        }
    }
}
